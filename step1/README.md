# Step 1

## Installation
Install Dependencies:
- [PyMuPDF](https://pypi.org/project/PyMuPDF/)
- [stanfordcorenlp](https://github.com/Lynten/stanford-corenlp)
- [Hugging Face transformers](https://huggingface.co/transformers/installation.html)(Pytorch)
- [scikit-learn](https://scikit-learn.org/stable/install.html)
- [Mendeley Python SDK](https://github.com/Mendeley/mendeley-python-sdk)(Optional)

## File Structure
- ``config.yaml``: Mendeley authentication configurations
- ``config.py``: Paths/Flags settings
- ``extract_annot.py``: Extract annotation from mendeley
- ``download_pdf.py``: Download pdfs from annotation file of mendeley
- ``highlights.py``: Add mendeley annotation to pdf & generate tsv dataset of sentences with binary labels
- ``model.py``: Train the ML models
- ``feature.py``: Feature extraction from dataset
- ``main.py``: Add highlights to pdf based on the model trained

## Get Annotation from mendeley
1. Configure ``config.yaml``, and run the following command:
```
python extract_annot.py
```
This generates ``annot.json``.

2. Download the pdfs based on the url provided in ``annot.json``.
```
python download_pdf.py
```

## Highlight pdf with ML model
1. Configure ``config.py`` for path settings.
2. Run ``highlights.py``, this generates tsv dataset for training from highlighted pdf (or mendeley)
```
python highlights.py
```
**Note:** Mendeley use a different coordinate than the pymupdf, conversion is done when add highlights to the pdf file.

3. Concatenate the tsv to generate the final file. (change accordingly as **dataset_folder** and **train_tsv_file** in ``config.py``)
```
cat dataset/*.tsv > all.tsv
```
4. Run ``model.py`` to train the model. This generate two pickle file, one is **preprocessed_file** for the preprocessed dataset, the other is **model_file** for the saved model.
```
python model.py
```
5. Run ``main.py`` to use the trained model to identify highlights and add to the pdf. To use a pre-trained model, unzip the ``model.zip`` and put the pickle as **model_file** in the ``config.py``.
```
python main.py
```

## Cross vaiidation results table
| Setting         | Model                  | F-score | Precision | Recall |
|-----------------|------------------------|---------|-----------|--------|
| Without SciBERT | SVC                    | 0.61    | 0.68      | 0.56   |
|                 | RandomForestClassifier | 0.65    | 0.67      | 0.64   |
|                 | LogisticRegression     | 0.55    | 0.52      | 0.58   |
|                 | MLPClassifier          | 0.64    | 0.66      | 0.62   |
| With SciBERT    | SVC                    | 0.68    | 0.72      | 0.64   |
|                 | RandomForestClassifier | 0.64    | 0.78      | 0.54   |
|                 | LogisticRegression     | 0.64    | 0.61      | 0.66   |
|                 | MLPClassifier          | **0.69**    | 0.70      | **0.69**   |

## Cross validation results
1. SVC
```
{
  "mean_fit_time": [
    15.91742787361145,
    28.407972288131713,
    24.592014646530153,
    18.13792939186096,
    28.574488639831543,
    17.974272537231446,
    40.67348103523254,
    26.826940774917603,
    12.826323175430298,
    587.7732527256012,
    26.70899691581726,
    10.515910053253174
  ],
  "std_fit_time": [
    0.3503388740419523,
    0.4338407209415072,
    0.0894335155632523,
    3.9190091267555953,
    0.33354083886266456,
    0.39255248188856645,
    9.982504136532617,
    2.0989944896801727,
    0.6319916328397001,
    972.5896995437394,
    2.8978525924997602,
    0.5227088666925196
  ],
  "mean_score_time": [
    4.038466548919677,
    9.332763671875,
    7.82556643486023,
    4.000244283676148,
    8.120949506759644,
    4.977642345428467,
    3.787499952316284,
    7.185365819931031,
    3.460734987258911,
    3.4304800510406492,
    6.238940143585205,
    2.794445276260376
  ],
  "std_score_time": [
    0.10037056578012492,
    0.032985509453697735,
    0.17254816316518898,
    0.13091209519401403,
    0.03771825079996514,
    0.15529979195525193,
    0.19470469492509238,
    0.2942746624612814,
    0.12074044516762872,
    0.17418641572039636,
    0.09288371877744006,
    0.12749621148157728
  ],
  "param_C": [
    1.0,
    1.0,
    1.0,
    10.0,
    10.0,
    10.0,
    100.0,
    100.0,
    100.0,
    1000.0,
    1000.0,
    1000.0
  ],
  "param_kernel": [
    "linear",
    "rbf",
    "sigmoid",
    "linear",
    "rbf",
    "sigmoid",
    "linear",
    "rbf",
    "sigmoid",
    "linear",
    "rbf",
    "sigmoid"
  ],
  "params": [
    {
      "C": 1.0,
      "kernel": "linear"
    },
    {
      "C": 1.0,
      "kernel": "rbf"
    },
    {
      "C": 1.0,
      "kernel": "sigmoid"
    },
    {
      "C": 10.0,
      "kernel": "linear"
    },
    {
      "C": 10.0,
      "kernel": "rbf"
    },
    {
      "C": 10.0,
      "kernel": "sigmoid"
    },
    {
      "C": 100.0,
      "kernel": "linear"
    },
    {
      "C": 100.0,
      "kernel": "rbf"
    },
    {
      "C": 100.0,
      "kernel": "sigmoid"
    },
    {
      "C": 1000.0,
      "kernel": "linear"
    },
    {
      "C": 1000.0,
      "kernel": "rbf"
    },
    {
      "C": 1000.0,
      "kernel": "sigmoid"
    }
  ],
  "split0_test_precision": [
    0.7008547008547008,
    0.8255813953488372,
    0.8024691358024691,
    0.7033898305084746,
    0.7889908256880734,
    0.7058823529411765,
    0.7033898305084746,
    0.7850467289719626,
    0.6964285714285714,
    0.7033898305084746,
    0.7256637168141593,
    0.6818181818181818
  ],
  "split1_test_precision": [
    0.7524752475247525,
    0.8717948717948718,
    0.9066666666666666,
    0.7378640776699029,
    0.8604651162790697,
    0.8181818181818182,
    0.7378640776699029,
    0.8160919540229885,
    0.7272727272727273,
    0.7378640776699029,
    0.7802197802197802,
    0.7238095238095238
  ],
  "split2_test_precision": [
    0.8181818181818182,
    0.8709677419354839,
    0.875,
    0.8,
    0.875,
    0.8347826086956521,
    0.8,
    0.8725490196078431,
    0.7931034482758621,
    0.8,
    0.8627450980392157,
    0.7787610619469026
  ],
  "split3_test_precision": [
    0.7024793388429752,
    0.8064516129032258,
    0.8192771084337349,
    0.7,
    0.7788461538461539,
    0.7105263157894737,
    0.7,
    0.7788461538461539,
    0.680327868852459,
    0.6974789915966386,
    0.7572815533980582,
    0.6837606837606838
  ],
  "split4_test_precision": [
    0.736,
    0.8431372549019608,
    0.8191489361702128,
    0.7131147540983607,
    0.7739130434782608,
    0.7652173913043478,
    0.7131147540983607,
    0.7981651376146789,
    0.6991150442477876,
    0.7131147540983607,
    0.7889908256880734,
    0.7008547008547008
  ],
  "mean_test_precision": [
    0.7419982210808492,
    0.8435865753768759,
    0.8445123694146167,
    0.7308737324553476,
    0.8154430278583115,
    0.7669180973824936,
    0.7308737324553476,
    0.8101397988127254,
    0.7192495320154814,
    0.7303695307746754,
    0.7829801948318573,
    0.7138008304379986
  ],
  "std_test_precision": [
    0.042905054519052195,
    0.025490508443600797,
    0.03959900988885743,
    0.03701685919984885,
    0.04321530091570941,
    0.05318241908350879,
    0.03701685919984885,
    0.03371256701005146,
    0.0398995296019482,
    0.0374486036848616,
    0.045501178401654074,
    0.03581314875019068
  ],
  "rank_test_precision": [
    7,
    2,
    1,
    8,
    3,
    6,
    8,
    4,
    11,
    10,
    5,
    12
  ],
  "split0_test_recall": [
    0.7454545454545455,
    0.6454545454545455,
    0.5909090909090909,
    0.7545454545454545,
    0.7818181818181819,
    0.7636363636363637,
    0.7545454545454545,
    0.7636363636363637,
    0.7090909090909091,
    0.7545454545454545,
    0.7454545454545455,
    0.6818181818181818
  ],
  "split1_test_recall": [
    0.7524752475247525,
    0.6732673267326733,
    0.6732673267326733,
    0.7524752475247525,
    0.7326732673267327,
    0.7128712871287128,
    0.7524752475247525,
    0.7029702970297029,
    0.7128712871287128,
    0.7524752475247525,
    0.7029702970297029,
    0.7524752475247525
  ],
  "split2_test_recall": [
    0.7317073170731707,
    0.6585365853658537,
    0.6829268292682927,
    0.7479674796747967,
    0.7398373983739838,
    0.7804878048780488,
    0.7479674796747967,
    0.7235772357723578,
    0.7479674796747967,
    0.7479674796747967,
    0.7154471544715447,
    0.7154471544715447
  ],
  "split3_test_recall": [
    0.7870370370370371,
    0.6944444444444444,
    0.6296296296296297,
    0.7777777777777778,
    0.75,
    0.75,
    0.7777777777777778,
    0.75,
    0.7685185185185185,
    0.7685185185185185,
    0.7222222222222222,
    0.7407407407407407
  ],
  "split4_test_recall": [
    0.7863247863247863,
    0.7350427350427351,
    0.6581196581196581,
    0.7435897435897436,
    0.7606837606837606,
    0.7521367521367521,
    0.7435897435897436,
    0.7435897435897436,
    0.6752136752136753,
    0.7435897435897436,
    0.7350427350427351,
    0.7008547008547008
  ],
  "mean_test_recall": [
    0.7605997866828584,
    0.6813491274080503,
    0.6469705069318689,
    0.7552711406225049,
    0.7530025216405317,
    0.7518264415559754,
    0.7552711406225049,
    0.7367547280056337,
    0.7227323739253225,
    0.7534192887706531,
    0.7242273908441501,
    0.718267205081984
  ],
  "std_test_recall": [
    0.0223197897902683,
    0.03139630366559586,
    0.033323480646220836,
    0.01187173832605551,
    0.017233443605347235,
    0.022279516354223435,
    0.01187173832605551,
    0.021259403003605622,
    0.03247934396438238,
    0.008443795154861614,
    0.014836044300182516,
    0.025748511640743234
  ],
  "rank_test_recall": [
    1,
    11,
    12,
    2,
    5,
    6,
    2,
    7,
    9,
    4,
    8,
    10
  ],
  "split0_test_f1": [
    0.722466960352423,
    0.7244897959183674,
    0.680628272251309,
    0.7280701754385965,
    0.7853881278538812,
    0.7336244541484715,
    0.7280701754385965,
    0.7741935483870966,
    0.7027027027027026,
    0.7280701754385965,
    0.73542600896861,
    0.6818181818181818
  ],
  "split1_test_f1": [
    0.7524752475247525,
    0.7597765363128492,
    0.7727272727272727,
    0.7450980392156863,
    0.7914438502673797,
    0.761904761904762,
    0.7450980392156863,
    0.7553191489361702,
    0.7200000000000001,
    0.7450980392156863,
    0.7395833333333333,
    0.7378640776699029
  ],
  "split2_test_f1": [
    0.7725321888412019,
    0.75,
    0.767123287671233,
    0.773109243697479,
    0.801762114537445,
    0.8067226890756304,
    0.773109243697479,
    0.7911111111111111,
    0.7698744769874476,
    0.773109243697479,
    0.7822222222222223,
    0.7457627118644069
  ],
  "split3_test_f1": [
    0.74235807860262,
    0.746268656716418,
    0.7120418848167539,
    0.7368421052631577,
    0.7641509433962265,
    0.7297297297297298,
    0.7368421052631577,
    0.7641509433962265,
    0.7217391304347825,
    0.7312775330396475,
    0.7393364928909952,
    0.7111111111111111
  ],
  "split4_test_f1": [
    0.7603305785123966,
    0.7853881278538813,
    0.7298578199052133,
    0.7280334728033474,
    0.7672413793103448,
    0.7586206896551725,
    0.7280334728033474,
    0.7699115044247787,
    0.6869565217391305,
    0.7280334728033474,
    0.7610619469026549,
    0.7008547008547008
  ],
  "mean_test_f1": [
    0.7500326107666788,
    0.7531846233603032,
    0.7324757074743564,
    0.7422306072836534,
    0.7819972830730555,
    0.7581204649027532,
    0.7422306072836534,
    0.7709372512510766,
    0.7202545663728126,
    0.7411176928389513,
    0.7515260008635631,
    0.7154821566636608
  ],
  "std_test_f1": [
    0.01695292986037182,
    0.019808506054372944,
    0.034447624886903006,
    0.01669026521165772,
    0.014336056351838175,
    0.027505765612655036,
    0.01669026521165772,
    0.01190478343743982,
    0.02786119867707576,
    0.017190495936656666,
    0.017796704323715287,
    0.02359743255635104
  ],
  "rank_test_f1": [
    6,
    4,
    10,
    7,
    1,
    3,
    7,
    2,
    11,
    9,
    5,
    12
  ]
}
0.7819972830730555      {'C': 10.0, 'kernel': 'rbf'}
```

2. RandomForest
```
    0.7105263157894737,
    0.7540983606557377,
    0.7435897435897436,
    0.782608695652174,
    0.7661290322580645,
    0.7692307692307693,
    0.7666666666666667,
    0.7401574803149606,
    0.7642276422764228,
    0.7642276422764228,
    0.7068965517241379,
    0.7478991596638656,
    0.75,
    0.7768595041322314,
    0.7540983606557377,
    0.7560975609756098,
    0.75,
    0.7692307692307693,
    0.7647058823529411,
    0.7560975609756098,
    0.7008547008547008,
    0.7583333333333333,
    0.75,
    0.7704918032786885,
    0.7580645161290323,
    0.7833333333333333,
    0.75,
    0.7666666666666667,
    0.7666666666666667,
    0.7603305785123967
  ],
  "mean_test_precision": [
    0.7051605574468639,
    0.8136340656310322,
    0.8208018991232725,
    0.8063549520593085,
    0.8047792894948624,
    0.8102445155997777,
    0.8002737490817392,
    0.815879507465254,
    0.8081947325491365,
    0.8125947146285105,
    0.7366144207461679,
    0.7845320375417464,
    0.8012093124044825,
    0.7846772138191459,
    0.8065116862701658,
    0.7943760773218856,
    0.7934463915782354,
    0.7992357937769702,
    0.7986045415640085,
    0.8003164058069749,
    0.7171041573559854,
    0.7947990919450502,
    0.7814296814296814,
    0.791811309381837,
    0.7944808078392293,
    0.7975225443585292,
    0.7979589830032308,
    0.7899549657777661,
    0.7875404769766763,
    0.7902083375370016,
    0.7533304831655656,
    0.7817044028545139,
    0.7826304951211273,
    0.7910030752666177,
    0.7905908715577065,
    0.7936878619231971,
    0.7935355127779622,
    0.7953588260590282,
    0.7893509597732946,
    0.7833817796660391,
    0.7220418019198507,
    0.7870859194861167,
    0.7934910525244198,
    0.793644737285559,
    0.7957081526616131,
    0.7925032973160311,
    0.7920229258073934,
    0.7970413508703748,
    0.7889987585300686,
    0.7945015330574849
  ],
  "std_test_precision": [
    0.04640131075602354,
    0.02263436376688028,
    0.02662784819784799,
    0.02592979056983019,
    0.04350106687875877,
    0.030868139800923334,
    0.04002253878094367,
    0.03326022043525561,
    0.04592933165626876,
    0.025138034285561186,
    0.05068556735227497,
    0.039094496881214115,
    0.023655763273314437,
    0.04457531134424916,
    0.03366375667061038,
    0.041501822208972784,
    0.03444735939813617,
    0.037428499241859994,
    0.02995408383783739,
    0.04452878849451686,
    0.02968034714716959,
    0.02962829203136059,
    0.03157251613949311,
    0.028819043873350953,
    0.03107788013363838,
    0.03221606766315598,
    0.035520248476878465,
    0.0424294365192355,
    0.03076671353987886,
    0.03112256249906967,
    0.036691681089842526,
    0.03749956393583981,
    0.03878322282064706,
    0.034051885682957854,
    0.033605173599849,
    0.03280670964857783,
    0.04535001657877336,
    0.0385368928056919,
    0.04011784971395304,
    0.031114428149845934,
    0.033210628281542656,
    0.04047060150275689,
    0.044022037140662246,
    0.036650310029277156,
    0.041366174215075754,
    0.02637424822309223,
    0.03900454056654695,
    0.03633996154846135,
    0.03280071550404176,
    0.036921049695998395
  ],
  "rank_test_precision": [
    50,
    3,
    1,
    8,
    9,
    5,
    12,
    2,
    6,
    4,
    47,
    41,
    10,
    40,
    7,
    23,
    28,
    13,
    14,
    11,
    49,
    20,
    45,
    31,
    22,
    16,
    15,
    35,
    38,
    34,
    46,
    44,
    43,
    32,
    33,
    24,
    26,
    19,
    36,
    42,
    48,
    39,
    27,
    25,
    18,
    29,
    30,
    17,
    37,
    21
  ],
  "split0_test_recall": [
    0.4666666666666667,
    0.6761904761904762,
    0.7238095238095238,
    0.7238095238095238,
    0.6952380952380952,
    0.7619047619047619,
    0.7333333333333333,
    0.7238095238095238,
    0.7238095238095238,
    0.6857142857142857,
    0.6666666666666666,
    0.8,
    0.8476190476190476,
    0.8095238095238095,
    0.8285714285714286,
    0.8,
    0.8285714285714286,
    0.819047619047619,
    0.819047619047619,
    0.8285714285714286,
    0.6571428571428571,
    0.8095238095238095,
    0.8285714285714286,
    0.8476190476190476,
    0.8571428571428571,
    0.8285714285714286,
    0.8380952380952381,
    0.8476190476190476,
    0.8285714285714286,
    0.8285714285714286,
    0.7142857142857143,
    0.8,
    0.8095238095238095,
    0.8285714285714286,
    0.8476190476190476,
    0.8476190476190476,
    0.8666666666666667,
    0.8476190476190476,
    0.8476190476190476,
    0.8476190476190476,
    0.780952380952381,
    0.8095238095238095,
    0.8666666666666667,
    0.8380952380952381,
    0.8571428571428571,
    0.8476190476190476,
    0.8476190476190476,
    0.8380952380952381,
    0.8571428571428571,
    0.8761904761904762
  ],
  "split1_test_recall": [
    0.6272727272727273,
    0.7,
    0.6818181818181818,
    0.7272727272727273,
    0.6909090909090909,
    0.6727272727272727,
    0.6909090909090909,
    0.6545454545454545,
    0.7090909090909091,
    0.6636363636363637,
    0.7454545454545455,
    0.8090909090909091,
    0.8272727272727273,
    0.8181818181818182,
    0.8727272727272727,
    0.8272727272727273,
    0.8363636363636363,
    0.8363636363636363,
    0.8363636363636363,
    0.8181818181818182,
    0.6636363636363637,
    0.8363636363636363,
    0.8545454545454545,
    0.8636363636363636,
    0.8727272727272727,
    0.8545454545454545,
    0.8545454545454545,
    0.8545454545454545,
    0.8363636363636363,
    0.8454545454545455,
    0.6363636363636364,
    0.8363636363636363,
    0.8909090909090909,
    0.8272727272727273,
    0.8272727272727273,
    0.8545454545454545,
    0.8545454545454545,
    0.8363636363636363,
    0.8545454545454545,
    0.8454545454545455,
    0.7,
    0.8636363636363636,
    0.8727272727272727,
    0.8636363636363636,
    0.8454545454545455,
    0.8636363636363636,
    0.8727272727272727,
    0.8636363636363636,
    0.8545454545454545,
    0.8454545454545455
  ],
  "split2_test_recall": [
    0.7168141592920354,
    0.7522123893805309,
    0.672566371681416,
    0.7079646017699115,
    0.7345132743362832,
    0.7610619469026548,
    0.7168141592920354,
    0.7256637168141593,
    0.7345132743362832,
    0.7433628318584071,
    0.6814159292035398,
    0.8495575221238938,
    0.8407079646017699,
    0.8141592920353983,
    0.8230088495575221,
    0.8495575221238938,
    0.8495575221238938,
    0.831858407079646,
    0.8495575221238938,
    0.8230088495575221,
    0.6991150442477876,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8407079646017699,
    0.8761061946902655,
    0.8761061946902655,
    0.8672566371681416,
    0.8849557522123894,
    0.8495575221238938,
    0.7522123893805309,
    0.8230088495575221,
    0.8672566371681416,
    0.8495575221238938,
    0.911504424778761,
    0.8938053097345132,
    0.8495575221238938,
    0.9026548672566371,
    0.8938053097345132,
    0.8849557522123894,
    0.7079646017699115,
    0.8495575221238938,
    0.8407079646017699,
    0.8938053097345132,
    0.8938053097345132,
    0.8849557522123894,
    0.8849557522123894,
    0.9203539823008849,
    0.9026548672566371,
    0.8761061946902655
  ],
  "split3_test_recall": [
    0.4728682170542636,
    0.7364341085271318,
    0.7209302325581395,
    0.7054263565891473,
    0.6511627906976745,
    0.6589147286821705,
    0.6976744186046512,
    0.6744186046511628,
    0.6589147286821705,
    0.6744186046511628,
    0.7209302325581395,
    0.7674418604651163,
    0.813953488372093,
    0.7751937984496124,
    0.8217054263565892,
    0.8294573643410853,
    0.8062015503875969,
    0.813953488372093,
    0.8062015503875969,
    0.7984496124031008,
    0.6124031007751938,
    0.8217054263565892,
    0.8294573643410853,
    0.8604651162790697,
    0.8449612403100775,
    0.8527131782945736,
    0.8217054263565892,
    0.8217054263565892,
    0.8294573643410853,
    0.8372093023255814,
    0.6821705426356589,
    0.8372093023255814,
    0.8449612403100775,
    0.875968992248062,
    0.8527131782945736,
    0.8604651162790697,
    0.8682170542635659,
    0.8449612403100775,
    0.875968992248062,
    0.8837209302325582,
    0.7441860465116279,
    0.875968992248062,
    0.8682170542635659,
    0.875968992248062,
    0.875968992248062,
    0.8682170542635659,
    0.8682170542635659,
    0.8682170542635659,
    0.8604651162790697,
    0.8449612403100775
  ],
  "split4_test_recall": [
    0.5555555555555556,
    0.6574074074074074,
    0.7314814814814815,
    0.6851851851851852,
    0.6481481481481481,
    0.6481481481481481,
    0.6388888888888888,
    0.6759259259259259,
    0.6666666666666666,
    0.6759259259259259,
    0.75,
    0.7777777777777778,
    0.7870370370370371,
    0.8240740740740741,
    0.7962962962962963,
    0.8148148148148148,
    0.7870370370370371,
    0.8333333333333334,
    0.8240740740740741,
    0.8148148148148148,
    0.75,
    0.8518518518518519,
    0.8055555555555556,
    0.8333333333333334,
    0.8796296296296297,
    0.8333333333333334,
    0.8518518518518519,
    0.8703703703703703,
    0.8703703703703703,
    0.8703703703703703,
    0.7592592592592593,
    0.8240740740740741,
    0.8611111111111112,
    0.8703703703703703,
    0.8518518518518519,
    0.8611111111111112,
    0.8333333333333334,
    0.8333333333333334,
    0.8425925925925926,
    0.8611111111111112,
    0.7592592592592593,
    0.8425925925925926,
    0.8333333333333334,
    0.8703703703703703,
    0.8703703703703703,
    0.8703703703703703,
    0.8611111111111112,
    0.8518518518518519,
    0.8518518518518519,
    0.8518518518518519
  ],
  "mean_test_recall": [
    0.5678354651682497,
    0.7044488763011093,
    0.7061211582697485,
    0.709931678925299,
    0.6839942798658584,
    0.7005513716730016,
    0.6955239782056,
    0.6908726451492452,
    0.6985990205171106,
    0.6886116023572291,
    0.7128934747765783,
    0.8007736138915394,
    0.8233180529805348,
    0.8082265584529426,
    0.8284618547018218,
    0.8242204857105042,
    0.8215462348967184,
    0.8269112968392655,
    0.827048880399364,
    0.8166053047057369,
    0.6764594731604404,
    0.8355703607483809,
    0.8353073765319085,
    0.8526921881027663,
    0.8590337928823214,
    0.849053917887011,
    0.8484608331078798,
    0.8522993872119207,
    0.8499437103717821,
    0.8462326337691639,
    0.7088583083849599,
    0.8241311724641628,
    0.8547523778044461,
    0.8503482081172964,
    0.8581922459633923,
    0.8635092078578392,
    0.8544640061865827,
    0.8529864249765463,
    0.8629062793479341,
    0.8645722773259304,
    0.7384724576986359,
    0.8482558560249442,
    0.8563304583185216,
    0.8683752548169095,
    0.8685484149900695,
    0.8669597176203473,
    0.8669260475866775,
    0.8684308980295808,
    0.8653320294151742,
    0.8589128616994433
  ],
  "std_test_recall": [
    0.09500751508591108,
    0.035596735061162524,
    0.024049496117570967,
    0.015032383781262468,
    0.031903788609866965,
    0.05035803126619937,
    0.03198835433856973,
    0.028667268041766798,
    0.03043025162682817,
    0.028256757404870374,
    0.033554316195758785,
    0.02859881062338175,
    0.021506250270889805,
    0.01719473389832044,
    0.024776791463093473,
    0.016454817310500802,
    0.022270541188419445,
    0.008772746475629627,
    0.014838358773588328,
    0.010193271494624906,
    0.04596143301623315,
    0.018209289964997284,
    0.019331148018590594,
    0.011075697614568851,
    0.015160133492970794,
    0.016982591022064685,
    0.01808914035312083,
    0.017396669776453093,
    0.023254998282761695,
    0.014054389432509981,
    0.04564428383704678,
    0.013448025930612572,
    0.02700217641665681,
    0.020320643142879485,
    0.028214245867441645,
    0.01591048218205957,
    0.012717207312328015,
    0.025387901053712362,
    0.019191838171714968,
    0.017011974003933325,
    0.030594572625319966,
    0.022532271289017625,
    0.016061842711509476,
    0.01815306877441411,
    0.016490656629203494,
    0.01201812719566265,
    0.012385191917988148,
    0.027979124379666744,
    0.018877547484135636,
    0.014281166180965194
  ],
  "rank_test_recall": [
    50,
    42,
    41,
    39,
    48,
    43,
    45,
    46,
    44,
    47,
    38,
    36,
    32,
    35,
    27,
    30,
    33,
    29,
    28,
    34,
    49,
    25,
    26,
    17,
    10,
    21,
    22,
    18,
    20,
    24,
    40,
    31,
    14,
    19,
    12,
    8,
    15,
    16,
    9,
    7,
    37,
    23,
    13,
    3,
    1,
    4,
    5,
    2,
    6,
    11
  ],
  "split0_test_f1": [
    0.5384615384615385,
    0.7434554973821991,
    0.7794871794871795,
    0.7676767676767677,
    0.7564766839378239,
    0.7960199004975124,
    0.7817258883248731,
    0.7715736040609136,
    0.7676767676767677,
    0.7539267015706806,
    0.693069306930693,
    0.8076923076923078,
    0.8317757009345795,
    0.794392523364486,
    0.8246445497630333,
    0.8000000000000002,
    0.8130841121495327,
    0.819047619047619,
    0.8113207547169811,
    0.820754716981132,
    0.676470588235294,
    0.8095238095238095,
    0.8093023255813954,
    0.8240740740740742,
    0.8372093023255814,
    0.820754716981132,
    0.8186046511627908,
    0.8240740740740742,
    0.8130841121495327,
    0.8093023255813954,
    0.7352941176470589,
    0.7962085308056872,
    0.8056872037914692,
    0.8130841121495327,
    0.8279069767441859,
    0.8202764976958524,
    0.8387096774193549,
    0.8202764976958524,
    0.8240740740740742,
    0.8127853881278538,
    0.7557603686635944,
    0.8095238095238095,
    0.8387096774193549,
    0.8110599078341013,
    0.8450704225352113,
    0.8127853881278538,
    0.8240740740740742,
    0.8148148148148148,
    0.8219178082191781,
    0.8440366972477065
  ],
  "split1_test_f1": [
    0.673170731707317,
    0.7623762376237623,
    0.7462686567164177,
    0.7729468599033816,
    0.7450980392156863,
    0.7290640394088671,
    0.7487684729064039,
    0.730964467005076,
    0.7684729064039408,
    0.73,
    0.7735849056603775,
    0.8090909090909091,
    0.8161434977578476,
    0.8144796380090498,
    0.8458149779735681,
    0.8272727272727273,
    0.8288288288288289,
    0.8325791855203618,
    0.8288288288288289,
    0.8294930875576038,
    0.6952380952380953,
    0.8141592920353982,
    0.8281938325991189,
    0.8370044052863437,
    0.8458149779735681,
    0.8281938325991189,
    0.8430493273542601,
    0.8355555555555555,
    0.8141592920353982,
    0.8266666666666667,
    0.693069306930693,
    0.8105726872246696,
    0.8448275862068965,
    0.8125,
    0.8125,
    0.8355555555555555,
    0.8355555555555555,
    0.8325791855203618,
    0.831858407079646,
    0.8230088495575221,
    0.7064220183486237,
    0.8225108225108226,
    0.8421052631578948,
    0.8444444444444444,
    0.8193832599118943,
    0.8333333333333333,
    0.8421052631578948,
    0.8333333333333333,
    0.8281938325991189,
    0.8266666666666667
  ],
  "split2_test_f1": [
    0.7168141592920354,
    0.7623318385650224,
    0.730769230769231,
    0.7476635514018691,
    0.7579908675799087,
    0.7853881278538813,
    0.7397260273972605,
    0.7627906976744186,
    0.7579908675799087,
    0.7636363636363637,
    0.6666666666666666,
    0.803347280334728,
    0.811965811965812,
    0.7698744769874477,
    0.7948717948717948,
    0.8,
    0.7966804979253111,
    0.7899159663865547,
    0.803347280334728,
    0.7815126050420168,
    0.6899563318777293,
    0.8151260504201682,
    0.7983539094650205,
    0.7950819672131147,
    0.7916666666666666,
    0.8114754098360656,
    0.8081632653061224,
    0.7999999999999999,
    0.8097165991902835,
    0.7966804979253111,
    0.7391304347826086,
    0.7782426778242678,
    0.7903225806451615,
    0.7901234567901234,
    0.824,
    0.8211382113821138,
    0.7868852459016393,
    0.8127490039840637,
    0.8015873015873016,
    0.8097165991902835,
    0.6956521739130435,
    0.7868852459016393,
    0.7851239669421488,
    0.8112449799196788,
    0.8112449799196788,
    0.8163265306122449,
    0.8097165991902835,
    0.832,
    0.8160000000000001,
    0.8048780487804879
  ],
  "split3_test_f1": [
    0.5865384615384616,
    0.7786885245901639,
    0.7815126050420168,
    0.7647058823529411,
    0.7433628318584071,
    0.7423580786026202,
    0.7627118644067796,
    0.7565217391304347,
    0.748898678414097,
    0.7499999999999999,
    0.744,
    0.792,
    0.8235294117647058,
    0.8130081300813007,
    0.8379446640316206,
    0.8392156862745098,
    0.8221343873517787,
    0.8267716535433071,
    0.8221343873517787,
    0.824,
    0.6810344827586207,
    0.8313725490196078,
    0.8262548262548264,
    0.8409090909090908,
    0.8320610687022901,
    0.8494208494208494,
    0.8313725490196078,
    0.8346456692913387,
    0.8326848249027237,
    0.8372093023255814,
    0.7426160337552743,
    0.8404669260700389,
    0.8384615384615384,
    0.8593155893536122,
    0.8461538461538461,
    0.8505747126436781,
    0.8615384615384616,
    0.8449612403100775,
    0.8593155893536122,
    0.8571428571428572,
    0.761904761904762,
    0.8625954198473282,
    0.8615384615384616,
    0.8593155893536122,
    0.8625954198473282,
    0.8517110266159695,
    0.8582375478927203,
    0.8648648648648649,
    0.8505747126436781,
    0.8449612403100775
  ],
  "split4_test_f1": [
    0.6091370558375634,
    0.7244897959183674,
    0.7559808612440192,
    0.7219512195121952,
    0.6896551724137931,
    0.7000000000000001,
    0.6865671641791045,
    0.7156862745098039,
    0.6990291262135923,
    0.7263681592039802,
    0.7431192660550459,
    0.7466666666666666,
    0.7762557077625571,
    0.7841409691629956,
    0.7818181818181819,
    0.7753303964757708,
    0.7727272727272728,
    0.7929515418502202,
    0.7946428571428571,
    0.7822222222222222,
    0.7297297297297298,
    0.7999999999999999,
    0.7733333333333334,
    0.8071748878923767,
    0.8189655172413792,
    0.8,
    0.8070175438596491,
    0.8,
    0.8138528138528139,
    0.8138528138528139,
    0.7321428571428572,
    0.7841409691629956,
    0.8017241379310345,
    0.8209606986899564,
    0.7999999999999999,
    0.8051948051948052,
    0.7894736842105262,
    0.8,
    0.801762114537445,
    0.8051948051948052,
    0.7288888888888888,
    0.7982456140350876,
    0.7894736842105262,
    0.817391304347826,
    0.8103448275862069,
    0.8245614035087719,
    0.8017241379310345,
    0.8070175438596491,
    0.8070175438596491,
    0.8034934497816595
  ],
  "mean_test_f1": [
    0.6248243893673833,
    0.754268378815903,
    0.7588037066517728,
    0.754988856169431,
    0.7385167190011239,
    0.7505660292725762,
    0.7438998834428843,
    0.7475073564761294,
    0.7484136692576613,
    0.7447862448822049,
    0.7240880290625565,
    0.7917594327569224,
    0.8119340260371004,
    0.7951791475210559,
    0.8170188336916396,
    0.8083637620046018,
    0.8066910197965449,
    0.8122531932696126,
    0.8120548216750347,
    0.807596526360595,
    0.6944858455678938,
    0.8140363401997966,
    0.8070876454467388,
    0.820848885075,
    0.8251435065818971,
    0.8219689617674332,
    0.8216414673404859,
    0.8188550597841935,
    0.8166995284261505,
    0.8167423212703537,
    0.7284505500516985,
    0.8019263582175318,
    0.8162046094072201,
    0.8191967713966448,
    0.8221121645796063,
    0.826547956494401,
    0.8224325249251075,
    0.822113185502071,
    0.8237194973264158,
    0.8215696998426644,
    0.7297256423437825,
    0.8159521823637375,
    0.8233902106536772,
    0.8286912451799326,
    0.8297277819600637,
    0.8277435364396348,
    0.8271715244492015,
    0.8304061113745324,
    0.8247407794643248,
    0.8248072205573196
  ],
  "std_test_f1": [
    0.06319799570876102,
    0.018605282483718132,
    0.019465497094696423,
    0.018563615597241876,
    0.0251239014641202,
    0.03567986069937416,
    0.03197768662349257,
    0.020881917226120737,
    0.025706929061449,
    0.014310255663090566,
    0.03864709392208342,
    0.02333208183329381,
    0.01907253570095938,
    0.01704797971639551,
    0.024717755024795025,
    0.022541066818444554,
    0.020115657996444915,
    0.017559050792626214,
    0.01234910198831641,
    0.021193855628270256,
    0.018807989806649238,
    0.010189489693488199,
    0.02016625148503115,
    0.017462684733662845,
    0.018865906737371516,
    0.01665280430608169,
    0.013840041485231866,
    0.015915492934279005,
    0.008147623258266803,
    0.014025473182433452,
    0.018038962166916278,
    0.022226401898627287,
    0.021470095387317922,
    0.022539298863009795,
    0.015469245319765491,
    0.015381647895908764,
    0.029381382308794692,
    0.015566791933736595,
    0.02147282045482473,
    0.018726013854063833,
    0.026145986341386724,
    0.02614704839238082,
    0.03051184842499,
    0.019641479751170234,
    0.020688162161171524,
    0.013927717742940335,
    0.020736212092079716,
    0.019943061050226477,
    0.014681955946403974,
    0.0180602521477531
  ],
  "rank_test_f1": [
    50,
    39,
    37,
    38,
    45,
    40,
    44,
    42,
    41,
    43,
    48,
    36,
    29,
    35,
    21,
    30,
    33,
    27,
    28,
    31,
    49,
    26,
    32,
    18,
    7,
    15,
    16,
    20,
    23,
    22,
    47,
    34,
    24,
    19,
    14,
    6,
    12,
    13,
    10,
    17,
    46,
    25,
    11,
    3,
    2,
    4,
    5,
    1,
    9,
    8
  ]
}
0.8304061113745324      {'max_samples': 0.9, 'n_estimators': 141}
[0]
'''

3.LogisticRegression
{
  "mean_fit_time": [
    300.60298862457273,
    152.7052116394043,
    149.31706366539,
    275.09808483123777,
    153.07894206047058,
    142.95452880859375,
    269.25132808685305,
    157.424054813385,
    148.4582818508148,
    269.57939047813414,
    159.64217667579652,
    144.83652172088622
  ],
  "std_fit_time": [
    0.7173603029538997,
    0.5948343281387333,
    1.143109145195687,
    2.125158993929003,
    1.2866082382459862,
    1.536111633504903,
    1.4936721231192231,
    7.177904590144739,
    9.059104196929091,
    2.984899814068645,
    9.593787074749404,
    8.467584557701834
  ],
  "mean_score_time": [
    0.011479568481445313,
    0.014478015899658202,
    0.0066359519958496095,
    0.006495809555053711,
    0.00648193359375,
    0.006460380554199219,
    0.006495475769042969,
    0.006488275527954101,
    0.006461954116821289,
    0.006523990631103515,
    0.006459379196166992,
    0.00798020362854004
  ],
  "std_score_time": [
    0.0039170620412137475,
    0.01525095015679964,
    0.0001784392818899978,
    6.647486245056863e-05,
    6.356927887350106e-05,
    7.30631236322441e-05,
    6.850127171782799e-05,
    7.016143122061754e-05,
    3.3991031711581895e-05,
    8.221848021024776e-05,
    3.563559484239007e-05,
    0.0034112188459407985
  ],
  "param_C": [
    1.0,
    1.0,
    1.0,
    10.0,
    10.0,
    10.0,
    100.0,
    100.0,
    100.0,
    1000.0,
    1000.0,
    1000.0
  ],
  "param_max_iter": [
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000,
    1000
  ],
  "param_penalty": [
    "l1",
    "l2",
    "none",
    "l1",
    "l2",
    "none",
    "l1",
    "l2",
    "none",
    "l1",
    "l2",
    "none"
  ],
  "param_solver": [
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga",
    "saga"
  ],
  "params": [
    {
      "C": 1.0,
      "max_iter": 1000,
      "penalty": "l1",
      "solver": "saga"
    },
    {
      "C": 1.0,
      "max_iter": 1000,
      "penalty": "l2",
      "solver": "saga"
    },
    {
      "C": 1.0,
      "max_iter": 1000,
      "penalty": "none",
      "solver": "saga"
    },
    {
      "C": 10.0,
      "max_iter": 1000,
      "penalty": "l1",
      "solver": "saga"
    },
    {
      "C": 10.0,
      "max_iter": 1000,
      "penalty": "l2",
      "solver": "saga"
    },
    {
      "C": 10.0,
      "max_iter": 1000,
      "penalty": "none",
      "solver": "saga"
    },
    {
      "C": 100.0,
      "max_iter": 1000,
      "penalty": "l1",
      "solver": "saga"
    },
    {
      "C": 100.0,
      "max_iter": 1000,
      "penalty": "l2",
      "solver": "saga"
    },
    {
      "C": 100.0,
      "max_iter": 1000,
      "penalty": "none",
      "solver": "saga"
    },
    {
      "C": 1000.0,
      "max_iter": 1000,
      "penalty": "l1",
      "solver": "saga"
    },
    {
      "C": 1000.0,
      "max_iter": 1000,
      "penalty": "l2",
      "solver": "saga"
    },
    {
      "C": 1000.0,
      "max_iter": 1000,
      "penalty": "none",
      "solver": "saga"
    }
  ],
  "split0_test_precision": [
    0.75,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181,
    0.7181818181818181
  ],
  "split1_test_precision": [
    0.7404580152671756,
    0.7185185185185186,
    0.7185185185185186,
    0.7205882352941176,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186,
    0.7185185185185186
  ],
  "split2_test_precision": [
    0.7874015748031497,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462,
    0.7611940298507462
  ],
  "split3_test_precision": [
    0.7241379310344828,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265,
    0.7264957264957265
  ],
  "split4_test_precision": [
    0.7401574803149606,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875,
    0.7421875
  ],
  "mean_test_precision": [
    0.7484310002839537,
    0.7333155186093618,
    0.7333155186093618,
    0.7337294619644817,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618,
    0.7333155186093618
  ],
  "std_test_precision": [
    0.02118178592460911,
    0.01643419062579038,
    0.01643419062579038,
    0.016078488057127263,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038,
    0.01643419062579038
  ],
  "rank_test_precision": [
    1,
    3,
    3,
    2,
    3,
    3,
    3,
    3,
    3,
    3,
    3,
    3
  ],
  "split0_test_recall": [
    0.7431192660550459,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348,
    0.7247706422018348
  ],
  "split1_test_recall": [
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8672566371681416,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177,
    0.8584070796460177
  ],
  "split2_test_recall": [
    0.7936507936507936,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095,
    0.8095238095238095
  ],
  "split3_test_recall": [
    0.7636363636363637,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727,
    0.7727272727272727
  ],
  "split4_test_recall": [
    0.8245614035087719,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334,
    0.8333333333333334
  ],
  "mean_test_recall": [
    0.7966749812993985,
    0.7997524274864536,
    0.7997524274864536,
    0.8015223389908783,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536,
    0.7997524274864536
  ],
  "std_test_recall": [
    0.04137007399864897,
    0.04693858216564018,
    0.04693858216564018,
    0.04922791819633476,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018,
    0.04693858216564018
  ],
  "rank_test_recall": [
    12,
    2,
    2,
    1,
    2,
    2,
    2,
    2,
    2,
    2,
    2,
    2
  ],
  "split0_test_f1": [
    0.7465437788018434,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118,
    0.7214611872146118
  ],
  "split1_test_f1": [
    0.7950819672131147,
    0.7822580645161291,
    0.7822580645161291,
    0.78714859437751,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291,
    0.7822580645161291
  ],
  "split2_test_f1": [
    0.7905138339920948,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846,
    0.7846153846153846
  ],
  "split3_test_f1": [
    0.7433628318584072,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097,
    0.748898678414097
  ],
  "split4_test_f1": [
    0.7800829875518672,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487,
    0.7851239669421487
  ],
  "mean_test_f1": [
    0.7711170798834655,
    0.7644714563404742,
    0.7644714563404742,
    0.7654495623127504,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742,
    0.7644714563404742
  ],
  "std_test_f1": [
    0.021932089752124476,
    0.02546001623532341,
    0.02546001623532341,
    0.02620750974894847,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341,
    0.02546001623532341
  ],
  "rank_test_f1": [
    1,
    3,
    3,
    2,
    3,
    3,
    3,
    3,
    3,
    3,
    3,
    3
  ]
}
0.7711170798834655      {'C': 1.0, 'max_iter': 1000, 'penalty': 'l1', 'solver': 'saga'}
```
